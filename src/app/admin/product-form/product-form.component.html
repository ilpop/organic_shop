<!-- product-form.component.html -->
<div class="row">
  <div class="col-md-6">
    <h3>Product Form</h3>
    <form [formGroup]="productFormService.productForm" (ngSubmit)="save()">
      <div class="form-group">
        <div class="input-group-prepend">
          <span class="form-group-text fixed-width" id="title">Title</span>
        </div>
        <input
          id="title"
          type="text"
          class="form-control"
          aria-label="Small"
          aria-describedby="inputGroup-sizing-sm"
          formControlName="title"
        />
        <div
          *ngIf="
            productFormService.productForm.get('title').hasError('required') &&
            productFormService.productForm.get('title').touched
          "
          class="text-danger"
        >
          Title is required.
        </div>
      </div>

      <div class="form-group">
        <div class="form-group-prepend">
          <span class="form-group-text fixed-width">€</span>
        </div>
        <input
          type="number"
          id="price"
          class="form-control currency-input"
          step="0.10"
          aria-label="Amount (to the nearest dollar)"
          formControlName="price"
        />
        <div
          *ngIf="
            productFormService.productForm.get('price').hasError('min') ||
            (productFormService.productForm.get('price').hasError('required') &&
              productFormService.productForm.get('price').touched)
          "
          class="text-danger"
        >
          Price cannot be negative.
        </div>
      </div>

      <div class="form-group">
        <span class="form-group-text fixed-width">Category</span>
        <select id="category" class="form-control" formControlName="category">
          <option value=""></option>
          <option *ngFor="let c of productFormService.categories$ | async">
            {{ c.name }}
          </option>
        </select>
        <div
          *ngIf="
            productFormService.productForm
              .get('category')
              .hasError('required') &&
            productFormService.productForm.get('category').touched
          "
          class="text-danger"
        >
          Category is required.
        </div>
      </div>

      <div class="form-group">
        <div class="form-group-prepend">
          <span class="form-group-text fixed-width">Image URL</span>
        </div>
        <input
          id="imageUrl"
          type="text"
          class="form-control"
          aria-label="Small"
          aria-describedby="inputGroup-sizing-sm"
          formControlName="imageUrl"
        />
        <div
          *ngIf="
            productFormService.productForm
              .get('imageUrl')
              .hasError('pattern') ||
            (productFormService.productForm
              .get('category')
              .hasError('required') &&
              productFormService.productForm.get('imageUrl').touched)
          "
          class="text-danger"
        >
          Invalid URL format.
        </div>
      </div>

      <button class="btn btn-primary">Save</button>
    </form>

    <div
      class="alert alert-success"
      *ngIf="productFormService.successMessage$ | async as successMessage"
    >
      {{ successMessage }}
    </div>

    <div
      class="alert alert-danger"
      *ngIf="productFormService.errorMessage$ | async as errorMessage"
    >
      {{ errorMessage }}
    </div>
  </div>

  <div class="col-md-6">
    <div class="card" style="width: 18rem">
      <div class="card-body">
        <h5 class="card-title">{{ productForm.controls.title.value }}</h5>
        <p class="card-text">Category: {{ productForm.controls.category.value }}</p>
        <p class="card-text">Price: €{{ productForm.controls.price.value | number:'1.2-2' }}</p>
        <img [src]="productForm.controls.imageUrl.value" class="card-img-top" alt="Product Image">
        <a href="#" class="btn btn-primary">Go somewhere</a>
      </div>
    </div>
  </div>
</div>
